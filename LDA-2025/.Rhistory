library(tidyverse)
library(lme4)
library(haven)
reading <- read_stata("data/read_long.dta")
View(reading)
head(reading)
reading %>%
group_by(t) %>%
summarise(read = mean(read, na.rm = T))
ggplot(data = reading %>% group_by(t) %>% summarise(read = mean(read, na.rm = T)), aes(y = read, x = t)) +
geom_line()
ggplot(data = reading %>% group_by(t) %>% summarise(read = mean(read, na.rm = T)), aes(y = read, x = t)) +
geom_line() + ylim(0,10)
ggplot(data = reading %>% group_by(t) %>% summarise(read = mean(read, na.rm = T)), aes(y = read, x = t)) +
geom_line() + ylim(0,10) +
theme_bw()
ggplot(data = reading %>% group_by(t) %>% summarise(read = mean(read, na.rm = T)), aes(y = read, x = t)) +
geom_line() + ylim(0,10) +
theme_minimal()
dev.off()
pdf(file = "plots/reading_basic.pdf")
ggplot(data = reading %>% group_by(t) %>% summarise(read = mean(read, na.rm = T)), aes(y = read, x = t)) +
geom_line() + ylim(0,10) +
theme_minimal()
dev.off()
reading %>% dplyr::filter(childid %in% c(1:10))
ggplot(data = reading %>% dplyr::filter(childid %in% c(1:10)), aes(y = read, x = t, group = childid, colour = childid)) +
geom_line() + ylim(0,10) +
theme_minimal()
ggplot(data = reading %>% dplyr::filter(childid %in% c(1:10)) %>% mutate(childid = factor(childid)), aes(y = read, x = t, group = childid, colour = childid)) +
geom_line() + ylim(0,10) +
theme_minimal()
pdf(file = "plots/reading_10.pdf")
ggplot(data = reading %>% dplyr::filter(childid %in% c(1:10)) %>% mutate(childid = factor(childid)), aes(y = read, x = t, group = childid, colour = childid)) +
geom_line() + ylim(0,10) +
theme_minimal()
dev.off()
##################################
### LONGITUDINAL DATA ANALYSIS ###
##################################
## Thiago R. Oliveira
## Day 1
# Install the lme4 package; you only need to do that once
## install.packages("lme4") # (uncomment if you need to install)
# Load the lme4 package
library(lme4)
## We are also going to use the tidyverse package, so let's load it now
# Install the tidyverse package; you only need to do that once
## install.packages("tidyverse") # (uncomment if you need to install)
# Load the tidyverse package
library(tidyverse)
# load the 'sleepstudy' dataset
data("sleepstudy", package = "lme4")
# If you want to read more about the dataset:
help("sleepstudy")
# we can use the nrow() function to check the number of observations
nrow(sleepstudy)
# checking how many individuals were part of the study
length(unique(sleepstudy$Subject))
# we can use the count() function
count(sleepstudy, Subject)
# pivot: from long to wide format
sleep_wide <-
sleepstudy %>%
pivot_wider(names_from = Days,
values_from = Reaction)
# checking that pivoting wider worked
head(sleep_wide)
# pivot: from wide to long
sleep_long <-
sleep_wide %>%
pivot_longer(
cols = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9'),
names_to = "Days",
values_to = "Reaction"
)
# check that pivoting longer worked
head(sleep_long)
# plotting trajectories
ggplot(sleepstudy, aes(x = Days, y = Reaction, group = Subject, color = Subject)) +
geom_line(show.legend = FALSE) +
labs(title = "Reaction Time by Day of Sleep Deprivation",
x = "Days",
y = "Reaction Time (ms)") +
theme_minimal()
